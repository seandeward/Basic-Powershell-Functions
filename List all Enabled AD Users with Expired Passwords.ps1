# Get all AD users that have enabled accounts and expired passwords
    # Purpose is to check for accounts that don't need to be enabled to tighten network security. Sorts by latest login (hence the use of lastLogonTimestamp instead of pulling the "lastLogonDate", which would sort results by the month (not year))
get-aduser -filter * -properties whenCreated, lastLogonTimestamp, lockedOut, PasswordExpired | Select-Object Name, Description, whenCreated, @{Name="Last Logon"; Expression={[DateTime]::FromFileTime($_.lastLogonTimestamp).ToString('yyyy-MM-dd hh:mm:ss')}}, Enabled, Lockedout, PasswordExpired  | Where-Object -Property Enabled -eq "True" <# filter results to only include enabled accounts #> | Where-Object -property  PasswordExpired -eq "True" <# filter results to only include accounts that have expired passwords #> | Sort-Object "Last Logon" | Format-Table -Autosize